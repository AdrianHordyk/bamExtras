getwd()
sink(file="ConsoleStuff.txt")
n <- 20;x1 <- 1:n+rnorm(n);x2 <- 1:n+rnorm(n,mean=2,sd=5);y <- 3+2*x1+4*x2
data <- data.frame(x1,x2,y)
data
mydata <- data.frame(x1,x2,y)
mydata
print(mydata)
2+4
sink()
2@+2
mydata
matrix(9,3,3)
library(bamExtras)
rdat_RedPorgy$parms$msy.klb
rdat <- rdat_RedPorgy$parms$msy.klb
rdat <- rdat_RedPorgy
with(rdat$t.series,plot(year,total.L.klb))
with(rdat$t.series,plot(year,total.L.klb,type="l"))
with(rdat$t.series,plot(year,total.L.klb,type="l"));abline(h=rdat_RedPorgy$parms$msy.klb)
with(rdat$t.series,plot(year,total.L.klb,type="l"));abline(h=rdat_RedPorgy$parms$msy.klb,lty=2)
with(rdat$t.series,plot(year,SSB,type="l"))
rdat <- rdat_GreaterAmberjack
with(rdat$t.series,plot(year,SSB,type="l"))
rdat <- rdat_Tilefish
with(rdat$t.series,plot(year,SSB,type="l"))
with(rdat$t.series,plot(year,SSB,type="l"));;abline(h=rdat_RedPorgy$parms$msst,lty=2)
with(rdat$t.series,plot(year,SSB,type="l"));abline(h=rdat_RedPorgy$parms$msst,lty=2)
with(rdat$t.series,plot(year,SSB,type="l"));abline(h=rdat_RedPorgy$parms$msst,lty=2)
with(rdat$t.series,plot(year,SSB,type="l"));abline(h=rdat$parms$msst,lty=2)
with(rdat$t.series,plot(year,SSB,type="l"));abline(h=rdat$parms$msy.klb,lty=2)
with(rdat$t.series,plot(year,SSB,type="l",ylim=range(c(0,SSbiexp()))));abline(h=rdat$parms$msy.klb,lty=2)
with(rdat$t.series,plot(year,SSB,type="l",ylim=range(c(0,SSB)));abline(h=rdat$parms$msy.klb,lty=2)
with(rdat$t.series,plot(year,SSB,type="l",ylim=range(c(0,SSB))); abline(h=rdat$parms$msy.klb,lty=2)
with(rdat$t.series,plot(year,SSB,type="l",ylim=range(c(0,SSB)))); abline(h=rdat$parms$msy.klb,lty=2)
rdat$parms$msy.klb
rdat$parms$msst
?catch_curve
with(rdat$t.series,plot(year,SSB,type="l",ylim=range(c(0,SSB)))); abline(h=rdat$parms$msst,lty=2)
?rdat_Tilefish
names(rdat)
str(rdat,2)
str(rdat,1)
?str
str(rdat,max.level=1)
vignette("tutorial","bamExtras")
# Chunk 1
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.width = 7,
warning = FALSE,
errors = FALSE,
messages = FALSE
)
# Chunk 2
# Install and load package
#devtools::install_github("nikolaifish/bamExtras")
library(bamExtras)
# Load dependencies
library(stringr)
# Chunk 3
# see all data objects in bamExtras
# data(package="bamExtras")$result[,"Item"]
# standardize naming conventions and assign shorter name
rdat_BS <- standardize_rdat(rdat_BlackSeaBass)
rdat_RP <- standardize_rdat(rdat_RedPorgy)
# Chunk 4
with(rdat_BS$t.series,
plot(year,B,type="o",col="black"))
# Chunk 5
ylim <- range(c(0,rdat_BS$t.series$B,rdat_RP$t.series$B))
with(rdat_BS$t.series,
plot(year,B,type="o",col="black",ylim=ylim)
)
with(rdat_RP$t.series,
points(year,B,type="o",col="red")
)
# Chunk 6
#install.packages("MSEtool")
library(MSEtool)
# Chunk 7
Stock_RP <- rdat_to_Stock(rdat_RP)
Fleet_RP <- rdat_to_Fleet(rdat_RP)
# Chunk 8
OM_RP <- new("OM", Stock=Stock_RP, Fleet=Fleet_RP, Obs=Precise_Unbiased, Imp=Perfect_Imp)
# Chunk 9
MSE_RP <- runMSE(OM_RP)
# Chunk 10
NOAA_plot(MSE_RP)
#install.packages("openMSE")
library(openMSE)
# read in black ses bass age comps used in the recent stock assessment
rdat <- rdat_BlackSeaBass
comp <- rdat$comp.mats # List of composition matrices
acomp <- comp[grepl("^acomp.*.ob$",names(comp))] # list of observed age composition matrices
comp_i <- acomp$acomp.Mcvt.ob
cc_i <- catch_curve(comp_i)
# Plot comps and add catch curves (note the log-tranformation of the composition data)
comp_plot(log(comp_i),cc=cc_i,fillComp = FALSE,ylab= "log(proportion)",xlab="age",title="black sea bass commercial handline catch curves")
# Plot Z estimates over time for multiple sets of age compositions
par(mfrow=c(1,1),mgp=c(1,.2,0),mar=c(2,2,1,1),oma=c(0,0,0,0),tck=0.01)
M <- rdat$parms$M.msst
cc <- lapply(acomp,catch_curve)
abb <- gsub("^(acomp.)|(.ob)$","",names(cc)) # abbreviations of age composition fleets
cols <- rainbow(length(cc))
xlim <- range(unlist(lapply(cc,function(x){as.numeric(x$year)})),na.rm=TRUE)
ylim <- range(c(0,unlist(lapply(cc,function(x){-as.numeric(x$slope)}))),na.rm=TRUE)
for(i in 1:length(cc)){
xi <- cc[[i]]
year <- xi$year
Z <- -xi$slope
if(i==1){
plot(year,Z,xlim=xlim,ylim=ylim,type="o",col=cols[i])
}else{
points(year,Z,type="o",col=cols[i])
}
}
# Add reference line for natural mortality
abline(h=M,lty=2,lwd=2)
text(par("usr")[1]+0.05*diff(par("usr")[1:2]),M,labels="M",pos=3)
legend("bottomleft",legend=abb,col=cols,pch=1,lty=1,bty="n")
# read in black ses bass age comps used in the recent stock assessment
rdat <- rdat_BlackSeaBass
comp <- rdat$comp.mats # List of composition matrices
acomp <- comp[grepl("^acomp.*.ob$",names(comp))] # list of observed age composition matrices
comp_i <- acomp$acomp.Mcvt.ob
cc_i <- catch_curve(comp_i)
# Plot comps and add catch curves (note the log-tranformation of the composition data)
comp_plot(log(comp_i),cc=cc_i,fillComp = FALSE,ylab= "log(proportion)",xlab="age",title="black sea bass commercial handline catch curves")
# Plot Z estimates over time for multiple sets of age compositions
par(mfrow=c(1,1),mgp=c(1,.2,0),mar=c(2,2,1,1),oma=c(0,0,0,0),tck=0.01)
M <- rdat$parms$M.msst
cc <- lapply(acomp,catch_curve)
abb <- gsub("^(acomp.)|(.ob)$","",names(cc)) # abbreviations of age composition fleets
cols <- rainbow(length(cc))
xlim <- range(unlist(lapply(cc,function(x){as.numeric(x$year)})),na.rm=TRUE)
ylim <- range(c(0,unlist(lapply(cc,function(x){-as.numeric(x$slope)}))),na.rm=TRUE)
for(i in 1:length(cc)){
xi <- cc[[i]]
year <- xi$year
Z <- -xi$slope
if(i==1){
plot(year,Z,xlim=xlim,ylim=ylim,type="o",col=cols[i])
}else{
points(year,Z,type="o",col=cols[i])
}
}
catchi
u
i
xi <- cc[[i]]
year <- xi$year
Z <- -xi$slope
plot(year,Z,xlim=xlim,ylim=ylim,type="o",col=cols[i])
year
Z
xlim
ylim
cols[i]
plot(1,4)
plot(year,Z)
year
class(year)
xi <- cc[[i]]
year <- as.numeric(xi$year)
Z <- -xi$slope
plot(year,Z,xlim=xlim,ylim=ylim,type="o",col=cols[i])
# read in black ses bass age comps used in the recent stock assessment
rdat <- rdat_BlackSeaBass
comp <- rdat$comp.mats # List of composition matrices
acomp <- comp[grepl("^acomp.*.ob$",names(comp))] # list of observed age composition matrices
comp_i <- acomp$acomp.Mcvt.ob
cc_i <- catch_curve(comp_i)
# Plot comps and add catch curves (note the log-tranformation of the composition data)
comp_plot(log(comp_i),cc=cc_i,fillComp = FALSE,ylab= "log(proportion)",xlab="age",title="black sea bass commercial handline catch curves")
# Plot Z estimates over time for multiple sets of age compositions
par(mfrow=c(1,1),mgp=c(1,.2,0),mar=c(2,2,1,1),oma=c(0,0,0,0),tck=0.01)
M <- rdat$parms$M.msst
cc <- lapply(acomp,catch_curve)
abb <- gsub("^(acomp.)|(.ob)$","",names(cc)) # abbreviations of age composition fleets
cols <- rainbow(length(cc))
xlim <- range(unlist(lapply(cc,function(x){as.numeric(x$year)})),na.rm=TRUE)
ylim <- range(c(0,unlist(lapply(cc,function(x){-as.numeric(x$slope)}))),na.rm=TRUE)
for(i in 1:length(cc)){
xi <- cc[[i]]
year <- as.numeric(xi$year)
Z <- -xi$slope
if(i==1){
plot(year,Z,xlim=xlim,ylim=ylim,type="o",col=cols[i])
}else{
points(year,Z,type="o",col=cols[i])
}
}
# Add reference line for natural mortality
abline(h=M,lty=2,lwd=2)
text(par("usr")[1]+0.05*diff(par("usr")[1:2]),M,labels="M",pos=3)
legend("bottomleft",legend=abb,col=cols,pch=1,lty=1,bty="n")
data(package="bamExtras")$result[,"Item"]
setwd("~/GitHub/myPackages/bamExtras")
source("~/GitHub/myPackages/bamExtras/update.package.bamExtras.r")
vignette("intro_to_bamExtras","bamExtras")
library("bamExtras")
vignette("intro_to_bamExtras","bamExtras")
vignette(package="bamExtras")
# Create vignette
usethis::use_vignette("intro_to_bamExtras")
